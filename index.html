<script>
  var teamsInitialized = false;
  microsoftTeams.initialize(() => {
    teamsInitialized = true;
    microsoftTeams.getContext((context, error) => {
      if (error) {
        console.error('Error getting context:', error);
        return;
      }
      (function (a, b) {      
        var loader = a.createElement('script');
        loader.type = 'text/javascript';
        loader.src = 'https://app-cdn.puzzel.com/public/js/pzl_loader.js';
        loader.setAttribute('id', 'pzlModuleLoader');
        loader.setAttribute('data-customer-id', b);
        loader.onload = function() {
          pzl.api.setClaims({
            "full_context": context,
            "user_email": context.upn
          });
        };
        a.body.appendChild(loader);
      })(document, '99201');
    });
  });
</script>
