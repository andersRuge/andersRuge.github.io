<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="robots" content="noindex">
    <link rel="icon" href="favicon.ico">
    <title>Microsoft Teams WebEngage widget page</title>
  </head>
  <body>
    <script src="msteams.min.js" type="text/javascript"></script>
    <script>
      var teamsInitialized = false;
      microsoftTeams.initialize(() => {
        teamsInitialized = true;
        microsoftTeams.getContext((context, error) => {(function (a, b) {      
            var loader = a.createElement('script');
            loader.type = 'text/javascript';
            loader.src = 'https://app-cdn.puzzel.com/public/js/pzl_loader.js';
            loader.setAttribute('id', 'pzlModuleLoader');
            loader.setAttribute('data-customer-id', b);
            a.body.append(loader);
          })(document, '99201');
          pzl.api.setClaims({
            "full_context": context,
            "user_email": context.upn
          });
        });
      });
      setTimeout(() => {
         if (!teamsInitialized) {
          document.getElementById('mainjs').insertAdjacentText('afterend',
            'This page does not work unless opened via Teams',
          );
        }
      }, 5000);
    </script>
  </body>
</html>
